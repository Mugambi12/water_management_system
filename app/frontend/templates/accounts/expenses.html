{% extends "base.html" %} {% block content %}

<!-- #MAIN BODY SECTION -->
<div class="container-fluid">
  <!-- Button to trigger add expense modal -->
  <ul class="nav nav-pills justify-content-end border-0">
    <li type="button" class="nav-item">
      <a
        class="nav-link"
        data-bs-toggle="modal"
        data-bs-target="#addExpenseModal"
        >New Expense</a
      >
    </li>
  </ul>

  <!-- Add Expense Modal -->
  <div
    class="modal fade"
    id="addExpenseModal"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    tabindex="-1"
    aria-labelledby="addExpenseModalLabel"
    aria-hidden="true"
  >
    <div
      class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"
    >
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title" id="addExpenseModalLabel">Add New Expense</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>

        <form
          method="POST"
          action="{{ url_for('accounts.expenses.add_expense') }}"
        >
          <!-- CSRF Token -->
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

          <!-- Modal Body -->
          <div class="modal-body">
            <div class="row">
              <div class="mb-3 col-md-6">
                <label for="expenseType" class="form-label">Expense Type</label>
                {{ add_expense_form.expense_type(class="form-select",
                id="expenseType") }}
              </div>

              <div class="mb-3 col-md-6">
                <label for="expenseVendor" class="form-label">Vendor</label>
                {{ add_expense_form.vendor(class="form-control",
                id="expenseVendor") }}
              </div>

              <div class="col-md-6 mb-3">
                <label for="expenseAmount" class="form-label">Amount</label>
                {{ add_expense_form.amount(class="form-control",
                id="expenseAmount") }}
              </div>
            </div>

            <div class="mb-3">
              <label for="expenseDescription" class="form-label"
                >Description</label
              >
              {{ add_expense_form.description(class="form-control",
              id="expenseDescription") }}
            </div>
          </div>

          <!-- Modal Footer -->
          <div class="modal-footer justify-content-between">
            <button
              type="button"
              class="btn btn-sm rounded-pill btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-sm rounded-pill btn-primary">
              Submit
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Page Title Details -->
  <div class="text-center">
    <h2 class="fw-bold text-success mb-2">Expense Tracker</h2>
    <p class="text-muted fst-italic">
      Keep tabs on your company's financial outflows.
    </p>
  </div>

  <!-- Expense Tracker Details Table -->
  <div class="col-md-12">
    <div class="card border-0 mb-3 shadow-sm">
      <div class="card-body">
        <h5 class="card-title border-bottom rounded mb-4 px-3">
          Expense Tracker
        </h5>
        <div class="table-responsive">
          <table
            class="table table-borderless text-center data-table"
            style="width: 100%"
          >
            <thead>
              <tr>
                <th scope="col">#</th>
                <th scope="col">ID</th>
                <th scope="col">UserID</th>
                <th scope="col">Date</th>
                <th scope="col">Expense Type</th>
                <th scope="col">Vendor</th>
                <th scope="col">Amount</th>
                <th scope="col">Description</th>
                <th scope="col">Status</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody>
              {% for expense in expenses %}
              <tr>
                <td>{{ loop.index }}</td>
                <td>{{ expense.id }}</td>
                <td>{{ expense.user_id }}</td>
                <td>{{ expense.timestamp.strftime('%Y-%m-%d') }}</td>
                <td>{{ expense.expense_type }}</td>
                <td>{{ expense.vendor }}</td>
                <td>{{ expense.amount }}</td>
                <td>{{ expense.description }}</td>
                <td>{{ expense.status }}</td>
                <td>
                  <button
                    class="btn btn-sm btn-primary"
                    data-bs-toggle="modal"
                    data-bs-target="#editExpenseModal"
                  >
                    Edit
                  </button>
                  <button
                    class="btn btn-sm btn-danger"
                    data-bs-toggle="modal"
                    data-bs-target="#deleteExpenseModal"
                  >
                    Delete
                  </button>
                </td>
              </tr>
              {% endfor %}

              <!-- Edit Expense Modal -->
              <div
                class="modal fade"
                id="editExpenseModal"
                data-bs-backdrop="static"
                data-bs-keyboard="false"
                tabindex="-1"
                aria-labelledby="editExpenseModalLabel"
                aria-hidden="true"
              >
                <div
                  class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"
                >
                  <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header">
                      <h5 class="modal-title" id="editExpenseModalLabel">
                        Edit Expense
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body">
                      <form>
                        <div class="row">
                          <div class="mb-3 col-md-6">
                            <label for="expenseType" class="form-label"
                              >Expense Type</label
                            >
                            <select class="form-select" id="expenseType">
                              <option value="">Select expense type</option>
                              <option value="equipmentAcquisition">
                                Equipment Acquisition
                              </option>
                              <option value="infrastructureRepairs">
                                Infrastructure Repairs
                              </option>
                              <option value="maintenance">
                                Maintenance Services
                              </option>
                              <option value="trainingAndCertifications">
                                Training and Certifications
                              </option>
                              <option value="utilities">
                                Utilities (e.g., electricity)
                              </option>
                              <option value="waterQualityTesting">
                                Water Quality Testing
                              </option>
                              <option value="waterTreatmentChemicals">
                                Water Treatment Chemicals
                              </option>
                              <!-- Add more options as needed -->
                            </select>
                          </div>

                          <div class="mb-3 col-md-6">
                            <label for="expenseVendor" class="form-label"
                              >Vendor</label
                            >
                            <input
                              type="text"
                              class="form-control"
                              id="expenseVendor"
                              placeholder="Enter vendor"
                            />
                          </div>

                          <div class="col-md-6 mb-3">
                            <label for="expenseAmount" class="form-label"
                              >Amount</label
                            >
                            <input
                              type="number"
                              class="form-control"
                              id="expenseAmount"
                              placeholder="Enter amount"
                            />
                          </div>

                          <div class="col-md-6 mb-3">
                            <label for="expenseDate" class="form-label"
                              >Date</label
                            >
                            <input
                              type="datetime-local"
                              class="form-control"
                              id="expenseDate"
                            />
                          </div>
                        </div>

                        <div class="mb-3">
                          <label for="expenseDescription" class="form-label"
                            >Description</label
                          >
                          <textarea
                            class="form-control"
                            id="expenseDescription"
                            rows="3"
                            placeholder="Enter description"
                          ></textarea>
                        </div>
                      </form>
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer justify-content-between">
                      <button
                        type="button"
                        class="btn btn-sm btn-secondary"
                        data-bs-dismiss="modal"
                      >
                        Cancel
                      </button>
                      <button type="button" class="btn btn-sm btn-primary">
                        Update
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Delete Expense Confirmation Modal -->
              <div
                class="modal fade"
                id="deleteExpenseModal"
                tabindex="-1"
                aria-labelledby="deleteExpenseModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog">
                  <div class="modal-content">
                    <!-- Modal Header -->
                    <div class="modal-header">
                      <h5 class="modal-title" id="deleteExpenseModalLabel">
                        Confirm Delete
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      ></button>
                    </div>

                    <!-- Modal Body -->
                    <div class="modal-body">
                      Are you sure you want to delete this expense?
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer justify-content-between">
                      <button
                        type="button"
                        class="btn btn-sm btn-secondary"
                        data-bs-dismiss="modal"
                      >
                        Cancel
                      </button>
                      <button type="button" class="btn btn-sm btn-danger">
                        Confirm
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}
